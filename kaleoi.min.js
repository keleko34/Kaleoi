window.__KaleoiExtensions__={config:{},components:{}};
window.kaleoi=function(){function P(a){var b=Q(),c=["solone","czosnek","frytki","pikantny","peprze"].filter(function(b){a:{var a=document.querySelectorAll("script"),c=a.len,d=0;for(d;d<c;d++)if(-1!==a[d].src.indexOf(b)){b=!0;break a}b=!1}return!b}),e=[],d=c.length,f=0;d||a();for(f;f<d;f++){var h=document.createElement("script");h.setAttribute("src",b+"/"+c[f]+"/"+c[f]+".js");h.setAttribute("type","text/javascript");h.setAttribute("title",c[f]);h.onload=function(){if("solone"===this.title)solone.init(function(){e.push(1);
if(e.length===d)return a()});else if(e.push(1),e.length===d)return a()};h.onerror=function(a){console.error("ERR! Script "+b+"/"+c[f]+"/init.js failed to load",a)};document.head.appendChild(h)}}function K(a,b){var c=document.createElement("script");c.title=a;c.type="text/javascript";c.textContent=b;document.head.appendChild(c);return c}function B(a,b){return new Promise(function(c,e){var d=new XMLHttpRequest;d.open("GET",a,!0);b&&Object.keys(b).forEach(function(a){d.setRequestHeader(a,b[a])});d.onreadystatechange=
function(){4===d.readyState&&(200===d.status?c(d.responseText):e(Error(d.status)))};d.send()})}function Q(){var a=document.querySelectorAll("script"),b=a.len,c=0;for(c;c<b;c++)if(-1!==a[c].src.indexOf("kaleoi"))return a[c].src.substring(0,a[c].src.indexOf("/kaleoi"));return"/node_modules"}function C(a){var b=__KaleoiExtensions__.config;Object.keys(a).forEach(function(c){b[c]&&"object"===typeof b[c]?b[c].length?b[c].concat(b[c]):Object.keys(b[c]).forEach(function(e){b[c][e]=a[c][e]}):b[c]=a[c]})}function R(){var a=
__KaleoiExtensions__.config.prefix||"";return Promise.all([B("/node_modules/kaleoi/config.js"),B(a+"/config.js"),B(a+"/auth-client.js")]).then(function(b,a,e){var c=K("config_setup","");e=K("auth",e);c.textContent=b.replace("module.exports","\r\nvar node_config")+a.replace("module.exports","\r\nvar local_config");C(node_config);C(local_config);local_config=node_config=null;document.head.removeChild(c);document.head.removeChild(e)}).catch(function(){console.error("Failed to fetch configs",arguments)})}
function m(a,b,c,e){return{value:a,writable:!!b,enumerable:!!c,configurable:!!e}}function D(a,b){var c=Object.keys(b),e=c.length,d=0;for(d;d<e;d++)a[c[d]]=b[c[d]];return a}function L(a,b){var c=Object.keys(b),e=c.length,d=0;for(d;d<e;d++)"function"===typeof b[c[d]]&&(b[c[d]]=b[c[d]].bind(a));return b}function S(a){var b=Object.keys(a),c=b.length,e=0;for(e;e<c;e++)a.isObservable(a,b[e])||a.set(b[e],a[b[e]],!0);return a}function E(a,b,c){if("string"===typeof a)return[a,b,c];if(a.length)return 1===a.length?
a.slice().concat([b,c]):2===a.length?a.slice().concat(c):a.slice();if("object"===typeof a){var e=Object.keys(a);return[e[0],a[e[0]]||b,c]}return[]}function T(a,b){t[a]||(t[a]=[]);t[a].push(b);F[a]&&b(F[a]);return u}function U(a,b){if(a=t[a]){var c=a.length,e=0;for(e;e<c;e++)if(a[e]===b){a.splice(e,1);break}}return u}function V(a,b){var c=t[a];if(c){var e=c.length,d=0;for(d;d<e;d++)c[d](b)}F[a]=b;return u}function G(a,b,c){(a="model"!==a?window[a+"Storage"].getItem(b):w.get(b))&&D(c,"string"===typeof a?
JSON.parse(a):a);return c}function H(a,b,c){window[a+"Storage"].setItem(b,JSON.stringify(c));return c}function x(a,b,c){var e=b.model.length&&"model"||b.session.length&&"session"||b.local.length&&"local",d=-1!==["local","session"].indexOf(e)?e+"Storage":e,f=d&&("model"!==d?window[d].getItem(b[e][0]):w.get(a));if(e)return void 0!==f?c.set(a,"string"===typeof f?JSON.parse(f):f):"model"!==e?window[d].setItem(b[e],c.get(a)):w.set(b[e],c.get(a))}function W(a,b){var c=Object.keys(b),e=c.length,d=0;for(d;d<
e;d++)a[c[d]]=b[c[d]];return a}function X(a,b){function c(a,c,f){Object.defineProperties(this,{sessionStorage:m(!1,!0),localStorage:m(!1,!0),store:m(!1,!0),multiple:m(!1,!0),filters:m(D({},I.filters)),innerHTML:m(c||"",!0),component:m(a,!0),onfinish:m(function(){},!0),__frytkiExtensions__:m(frytki().__frytkiExtensions__,!0)});b.apply(this,arguments);this.filters=L(this,this.filters);this.localStorage&&(G("local",this.name,this),this.addEventListener("*update",function(){H("local",this.name,this)}.bind(this)));
this.sessionStorage&&(G("session",this.name,this),this.addEventListener("*update",function(){H("session",this.name,this)}.bind(this)));this.store&&(G("model",this.name,this),this.addEventListener("*update",function(){H("model",this.name,this)}.bind(this)));f&&W(this,f);L(this,this);return S(this)}c.prototype=frytki();c.prototype=D(c.prototype,b.prototype);c.prototype.name=a;c.prototype.listen=T;c.prototype.unlisten=U;c.prototype.alert=V;return c}function M(a){var b=!!y[a];return solone(a).then(function(c){var e=
c.prototype.__extensionsHTML__,d=c.prototype.__extensionsCSS__;b||(y[a]=X(a,c));czosnek.register(a,e,d);return y[a]}).catch(function(){throw Error("ERR! Failed to retrieve component "+a);})}function Y(a){a=a.map(function(a){return M(a)});return Promise.all(a)}function Z(a){var b=[],c=a.length,e=0;for(e;e<c;e++){var d=a[e].nodeName.toLowerCase();czosnek.isRegistered(d)||b.push(d)}return b}function N(a){var b=czosnek.getUnknown(a),c=Z(b),e=b.length,d=0;if(c.length)Y(c).then(function(){for(d;d<e;d++)z(b[d])}).catch(function(a){console.error("Failed to fetch components: ",
c,a)});else if(b.length)for(d;d<e;d++)z(b[d])}function z(a){var b=a.nodeName.toLowerCase(),c=new czosnek(b),e=c.maps,d=aa.call(a.attributes),f={},h=d.length,p=0;for(p;p<h;p++)f[d[p].name]=d[p].value;d=c.component;h=new y[b](d,a.childNodes,f);p=e.length;var v=0;Object.defineProperty(d,"__KaleoiExtensions__",m({title:b,vm:h,params:f,root:d}));a.parentElement&&a.parentElement.replaceChild(d,a);for(v;v<p;v++)switch(b=e[v],a=h,b.type){case "insert":f=b.key;x(f,b.filters,a);b.value=a.get(f);b.local[b.localAttr]=
q(b.mapText,a);break;case "standard":f=b.key;x(f,b.filters,a);b.value=a.get(f);b.local[b.localAttr]=q(b.mapText,a);b.isDirty||O(f,b,a);"function"!==typeof b.value||b.isEvent||J(b,a);A(f,b,a);break;case "event":f=b.key;b.local.removeAttribute(b.localAttr);b.value=a.get(f);b.local[b.localAttr]=b.value;O(f,b,a);A(f,b,a);break;case "stylesheet":f=b.key;x(f,b.filters,a);b.value=a.get(f);b.local[b.localAttr]=q(b.mapText,a);"function"===typeof b.value?J(b,a):A(f,b,a);if(b.values.length){f=a;var k=b.values.length;
var l=0;for(l;l<k;l++)a=b.values[l],"string"!==typeof a&&(a.value=f.get(a.key),"function"===typeof a.value?J(a,f):A(a.key,a,f))}break;case "style":for(k=b.key,f=0,x(k,b.filters,a),b.value=a.get(k),l=Object.keys(b.value),a=l.length,f;f<a;f++)k=b.value[l[f]],b.local[b.localAttr][l[f]]=runThroughStyleMap(l[f],k),"function"===typeof k&&bindStyleFunction(b,l[f],k),bindStyleData(b,l[f],k),bindStyleDom(b,l[f],k)}if(h.onfinish)h.onfinish();N(d);return c}function r(a,b,c){var e=b.length,d=0;for(d;d<e;d++)a=
c[b[d]]?c[b[d]](a):a;return a}function q(a,b){var c="",e=a.length,d=0;for(d;d<e;d++){var f=a[d];if("string"===typeof f)c+=f;else if(void 0!==f.value){if(f.values.length){var h=b,p=f.values,m="",k=p.length,l=0;for(l;l<k;l++){var n=p[l];if("string"===typeof n)m+=n;else{n.value||(n.value=h.get(n.key));var g="function"===typeof n.value?n.value.call(h,n.funcValue):n.value;m+=r(g,n.filters.filters,h.filters);"insert"===n.type&&(p[l]=g,n.maps.splice(n.mapIndex,1))}}g=m;g="function"===typeof f.value?E(f.value.call(b,
g),g):E(f.value,g);g=r(g,f.filters.filters,b.filters);c+=g[0]+":"+g[1]+";"}else if(f.isFullStyle)if(g="function"===typeof f.value?f.value.call(b,f.funcValue):f.value,"object"!==typeof g)console.error(Error("A full class stylesheet bind must return an object of styles")),g="";else{n=g=r(g,f.filters.filters,b.filters);h=Object.keys(n);p="";m=h.length;k=0;for(k;k<m;k++)p+=h[k]+":"+n[h[k]]+";";c+=p}else f.isFullProp?(g="function"===typeof f.value?f.value.call(b,f.funcValue):f.value,"object"!==typeof g?
(console.error(Error("A full property stylesheet bind must return an object of style name and value")),g=""):g=E(g,""),g=r(g,f.filters.filters,b.filters),c+=g[0]+":"+g[1]):(g="function"===typeof f.value?f.value.call(b,f.funcValue):f.value,c+=r(g,f.filters.filters,b.filters));"insert"===f.type&&(a[d]=r(g,f.filters.filters,b.filters))}}return c}function J(a,b){var c=b.findLayer(a.key),e=a.key.split(".").pop();a.funclistener=function(c){"function"!==typeof c.value&&(c.preventDefault(),a.funcValue=c.value,
(a.local.stop?a.local.stop():a.local)[a.localAttr]=q(a.mapText,b))};a.datalistener=function(c){(a.local.stop?a.local.stop():a.local)[a.localAttr]=q(a.mapText,b)};if(!c||!c[e])return!!console.error("Component: "+b.name,Error("You are missing the binding property of "+e));c.addEventListener(e,a.funclistener)}function A(a,b,c){b.datalistener=function(a){b.value=a.value;(b.local.stop?b.local.stop():b.local)[b.localAttr]="event"===b.type?b.value:q(b.mapText,c)};var e=c.findLayer(a);a=a.split(".").pop();
if(!e||!e[a])return!!console.error("Component: "+c.name,Error("You are missing the binding property of "+a));e.addEventListener(a+"update",b.datalistener)}function O(a,b,c){b.domListener=function(e){"function"!==typeof b.value||b.isEvent||"function"===typeof e.value?(b.value=e.value,c.stop().set(a,r(e.value,b.filters.vmFilters,c.filters))):(b.funcValue=e.value,(b.local.stop?b.local.stop():b.local)[b.localAttr]=q(b.mapText,c))};b.node.addEventListener(b.listener+"update",b.domListener)}function u(a){return P(function(){R().then(function(){a&&
C(a);solone.useBackend=!!I.backendRouting;solone.prefix(I.prefix);w=__KaleoiExtensions__.model=frytki(__KaleoiExtensions__.model);N(document.body)}).catch(function(){throw Error("ERR! Failed constructor");})})}var I=__KaleoiExtensions__.config,y=__KaleoiExtensions__.components,w=__KaleoiExtensions__.model,aa=Array.prototype.slice,F={},t={};Object.defineProperties(u,{createComponent:m(function(a){var b=a.nodeName.toLowerCase();return new Promise(function(c,e){czosnek.isRegistered(b)?c(z(a).component):
M(b).then(function(){return z(a)}).then(function(a){c(a.component)}).catch(function(a){console.error("Failed to fetch component: ",b,a);e()})})}),removeComponent:m(function(a){a.__CzosnekRoot__.destruct();a.parentElement.removeChild(a)})});return u}();